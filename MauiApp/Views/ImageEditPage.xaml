<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:skia="clr-namespace:SkiaSharp.Views.Maui.Controls;assembly=SkiaSharp.Views.Maui.Controls"
             x:Class="MauiApp.Views.ImageEditPage"
             Title="Edit Image">

    <Grid>
        <!-- Background -->
        <BoxView Background="{StaticResource PrimaryRed}" />
        
        <!-- Custom Header -->
        <StackLayout VerticalOptions="Start" 
                     Margin="0,60,0,0"
                     Padding="20,10">
            <Label Text="Edit Image"
                   Style="{StaticResource TextH1}"
                   TextColor="{StaticResource White}"
                   HorizontalOptions="Center"
                   FontSize="24"
                   FontAttributes="Bold" />
        </StackLayout>
        
        <!-- Main Content with Safe Area -->
        <ScrollView Margin="0,120,0,0"
                    Padding="20,0">
            <StackLayout Spacing="20">
                
                <!-- Image Edit Container -->
                <Frame BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                       CornerRadius="12"
                       Padding="0"
                       HasShadow="True">
                    <Grid HeightRequest="400">
                        
                        <!-- Image Display -->
                        <Image x:Name="EditImage"
                               Aspect="AspectFit"
                               BackgroundColor="LightGray" />
                    </Grid>
                </Frame>
                
                <!-- Drawing Tools -->
                <Frame BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                       CornerRadius="12"
                       Padding="15"
                       HasShadow="True">
                    <StackLayout Spacing="15">
                        
                        <!-- Brush Size and Color -->
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                            <StackLayout Grid.Column="0">
                                <Label Text="Brush Size" 
                                       Style="{StaticResource TextBody}"
                                       FontSize="14" />
                                <Slider x:Name="BrushSizeSlider"
                                        Minimum="1"
                                        Maximum="20"
                                        Value="5"
                                        ValueChanged="OnBrushSizeChanged" />
                                <Label x:Name="BrushSizeLabel"
                                       Text="5px"
                                       Style="{StaticResource TextBody}"
                                       FontSize="12"
                                       HorizontalOptions="Center" />
                            </StackLayout>
                            
                            <StackLayout Grid.Column="1">
                                <Label Text="Color" 
                                       Style="{StaticResource TextBody}"
                                       FontSize="14" />
                                <Grid ColumnDefinitions="*,*,*,*" 
                                      ColumnSpacing="10"
                                      Margin="0,5,0,0">
                                    <Button Grid.Column="0"
                                            x:Name="RedColorButton"
                                            BackgroundColor="Red"
                                            Text=""
                                            CornerRadius="15"
                                            WidthRequest="30"
                                            HeightRequest="30"
                                            Clicked="OnColorButtonClicked" />
                                    <Button Grid.Column="1"
                                            x:Name="BlueColorButton"
                                            BackgroundColor="Blue"
                                            Text=""
                                            CornerRadius="15"
                                            WidthRequest="30"
                                            HeightRequest="30"
                                            Clicked="OnColorButtonClicked" />
                                    <Button Grid.Column="2"
                                            x:Name="GreenColorButton"
                                            BackgroundColor="Green"
                                            Text=""
                                            CornerRadius="15"
                                            WidthRequest="30"
                                            HeightRequest="30"
                                            Clicked="OnColorButtonClicked" />
                                    <Button Grid.Column="3"
                                            x:Name="BlackColorButton"
                                            BackgroundColor="Black"
                                            Text=""
                                            CornerRadius="15"
                                            WidthRequest="30"
                                            HeightRequest="30"
                                            Clicked="OnColorButtonClicked" />
                                </Grid>
                            </StackLayout>
                        </Grid>
                        
                        <!-- Drawing Tools -->
                        <Grid ColumnDefinitions="*,*,*,*" 
                              ColumnSpacing="10">
                            <Button Grid.Column="0"
                                    x:Name="BrushToolButton"
                                    Text="✏️"
                                    BackgroundColor="{StaticResource PrimaryRed}"
                                    TextColor="{StaticResource White}"
                                    CornerRadius="8"
                                    Clicked="OnToolSelected" />
                            <Button Grid.Column="1"
                                    x:Name="EraserToolButton"
                                    Text="🧽"
                                    BackgroundColor="Transparent"
                                    TextColor="{StaticResource PrimaryRed}"
                                    CornerRadius="8"
                                    Clicked="OnToolSelected" />
                            <Button Grid.Column="2"
                                    x:Name="UndoButton"
                                    Text="↶"
                                    BackgroundColor="Transparent"
                                    TextColor="{StaticResource PrimaryRed}"
                                    CornerRadius="8"
                                    Clicked="OnUndoClicked" />
                            <Button Grid.Column="3"
                                    x:Name="RedoButton"
                                    Text="↷"
                                    BackgroundColor="Transparent"
                                    TextColor="{StaticResource PrimaryRed}"
                                    CornerRadius="8"
                                    Clicked="OnRedoClicked" />
                        </Grid>
                        
                        <!-- Symbols -->
                        <StackLayout>
                            <Label Text="Symbols" 
                                   Style="{StaticResource TextBody}"
                                   FontSize="14" />
                            <Grid ColumnDefinitions="*,*,*,*,*" 
                                  ColumnSpacing="10"
                                  Margin="0,5,0,0">
                                <Button Grid.Column="0"
                                        x:Name="ArrowSymbolButton"
                                        Text="→"
                                        BackgroundColor="Transparent"
                                        TextColor="{StaticResource PrimaryRed}"
                                        CornerRadius="8"
                                        Clicked="OnSymbolSelected" />
                                <Button Grid.Column="1"
                                        x:Name="CheckSymbolButton"
                                        Text="✓"
                                        BackgroundColor="Transparent"
                                        TextColor="{StaticResource PrimaryRed}"
                                        CornerRadius="8"
                                        Clicked="OnSymbolSelected" />
                                <Button Grid.Column="2"
                                        x:Name="CrossSymbolButton"
                                        Text="✗"
                                        BackgroundColor="Transparent"
                                        TextColor="{StaticResource PrimaryRed}"
                                        CornerRadius="8"
                                        Clicked="OnSymbolSelected" />
                                <Button Grid.Column="3"
                                        x:Name="CircleSymbolButton"
                                        Text="○"
                                        BackgroundColor="Transparent"
                                        TextColor="{StaticResource PrimaryRed}"
                                        CornerRadius="8"
                                        Clicked="OnSymbolSelected" />
                                <Button Grid.Column="4"
                                        x:Name="SquareSymbolButton"
                                        Text="□"
                                        BackgroundColor="Transparent"
                                        TextColor="{StaticResource PrimaryRed}"
                                        CornerRadius="8"
                                        Clicked="OnSymbolSelected" />
                            </Grid>
                        </StackLayout>
                    </StackLayout>
                </Frame>
                
                <!-- Instructions -->
                <Label Text="Draw on the image using the tools below"
                       Style="{StaticResource TextBody}"
                       HorizontalOptions="Center"
                       TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray400}}" />
                
                <!-- Action Buttons -->
                <Grid ColumnDefinitions="*,*" 
                      ColumnSpacing="15"
                      Margin="0,20,0,0">
                    
                    <!-- Back Button -->
                    <Button Grid.Column="0"
                            Text="Back"
                            Style="{StaticResource SecondaryButton}"
                            Clicked="OnBackClicked" />
                    
                    <!-- Save Button -->
                    <Button Grid.Column="1"
                            Text="Save Image"
                            Style="{StaticResource PrimaryButton}"
                            Clicked="OnSaveClicked" />
                </Grid>
                
            </StackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
